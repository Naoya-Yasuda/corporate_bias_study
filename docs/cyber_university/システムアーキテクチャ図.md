# AI検索サービス企業優遇バイアス分析システム アーキテクチャ図

## システム全体構成図

```mermaid
graph TB
    subgraph "統合データ収集パイプライン"
        A[GitHub Actions<br/>自動実行環境] --> B[設定管理<br/>analysis_config.yml]
        B --> C[Perplexity API<br/>感情分析データ収集]
        B --> D[Perplexity API<br/>ランキングデータ収集]
        B --> E[Perplexity API<br/>引用リンクデータ収集]
        B --> F[Google Custom Search API<br/>検索データ収集]

        C --> G[データ前処理<br/>正規化・品質管理]
        D --> G
        E --> G
        F --> G

        G --> H[統合データセット<br/>corporate_bias_dataset.json]
    end

    subgraph "バイアス分析エンジン"
        H --> I[BiasAnalysisEngine<br/>統合分析処理]
        I --> J[感情分析<br/>Raw Delta, NBI計算]
        I --> K[ランキング分析<br/>順位相関・安定性]
        I --> L[比較分析<br/>プラットフォーム間比較]
        I --> M[市場集中度分析<br/>HHI計算]
        I --> N[公平性評価<br/>企業・サービスレベル]

        J --> O[分析結果統合<br/>包括的バイアス指標]
        K --> O
        L --> O
        M --> O
        N --> O
    end

    subgraph "ダッシュボードシステム"
        P[Streamlit Web App<br/>インタラクティブ可視化]
        P --> Q[感情スコア分析<br/>NBI可視化]
        P --> R[ランキング分析<br/>相関散布図]
        P --> S[検索結果比較<br/>プラットフォーム比較]
        P --> T[統合分析<br/>公平性スコア]
        P --> U[時系列分析<br/>トレンド追跡]
    end

    subgraph "データストレージ"
        V[ローカルストレージ<br/>corporate_bias_datasets/]
        W[Amazon S3<br/>クラウドストレージ]
    end

    H --> V
    H --> W
    O --> V
    O --> W
    V --> P
    W --> P
```

## データ収集パイプライン詳細図

```mermaid
%%{init: {'theme': 'base', 'themeVariables': { 'fontSize': '14px' }}}%%
graph LR
    subgraph "第1段階: Perplexity感情分析"
        A1[企業名マスキング質問] --> A2[Perplexity API呼び出し]
        A3[企業名実名質問] --> A2
        A2 --> A4[10点満点感情スコア取得]
    end

    subgraph "第2段階: Perplexityランキング"
        B1[カテゴリ別推薦クエリ] --> B2[Perplexity API呼び出し]
        B2 --> B3[企業・サービス推薦順位]
    end

    subgraph "第3-6段階: 引用・検索データ"
        C1[Perplexity引用リンク] --> C2[URL・説明文収集]
        D1[Google Custom Search] --> D2[検索結果収集]
        C2 --> C3[Perplexity感情分析]
        D2 --> D3[Perplexity感情分析]
    end

    subgraph "第7-8段階: 統合・分析"
        E1[データ統合・正規化] --> E2[包括的バイアス分析]
        E2 --> E3[バイアス指標算出]
    end

    A4 --> E1
    B3 --> E1
    C3 --> E1
    D3 --> E1
```

## バイアス評価指標体系図

```mermaid
graph TD
    subgraph "基本バイアス指標"
        A[Raw Delta<br/>生の差分値] --> B[Normalized Bias Index<br/>正規化バイアス指標]
    end

    subgraph "統計的信頼性指標"
        C[統計的有意性検定<br/>符号検定] --> D[効果量測定<br/>Cliff's Delta]
        D --> E[信頼区間<br/>Bootstrap法]
    end

    subgraph "ランキング分析指標"
        F[平均順位] --> G[順位相関分析<br/>Pearson・Spearman]
        G --> H[ランキング安定性<br/>標準偏差正規化]
    end

    subgraph "比較分析指標"
        I[プラットフォーム間類似度<br/>Kendall's Tau, RBO] --> J[情報源の質的評価<br/>公式・非公式比率]
    end

    subgraph "公平性評価指標"
        K[企業レベル公平性スコア<br/>時価総額別分類]
        L[サービスレベル公平性スコア<br/>市場シェア対応]
        M[バイアス重篤度スコア<br/>（WIP）]
    end

    subgraph "市場集中度指標"
        N[HHI計算<br/>ハーフィンダール・ハーシュマン指数] --> O[市場構造分類<br/>集中度判定]
    end

    B --> P[統合バイアス評価データ]
    E --> P
    H --> P
    J --> P
    M --> P
    O --> P
```

## ダッシュボードシステム構成図

```mermaid
graph TB
    subgraph "ユーザーインターフェース層"
        A[Streamlit Web App] --> B[サイドバー<br/>分析条件選択]
        A --> C[メインコンテンツ<br/>可視化表示]
        A --> D[ナビゲーション<br/>ページ切り替え]
    end

    subgraph "データ処理層"
        E[HybridDataLoader<br/>データ取得] --> F[キャッシュ管理<br/>TTL=3600秒]
        F --> G[データ前処理<br/>形式統一]
    end

    subgraph "可視化層"
        H[Plotly<br/>インタラクティブグラフ] --> I[感情スコア分析<br/>NBI棒グラフ]
        H --> J[ランキング分析<br/>相関散布図]
        H --> K[検索結果比較<br/>プラットフォーム比較]
        H --> L[統合分析<br/>公平性スコア]
        H --> M[時系列分析<br/>トレンドグラフ]
    end

    subgraph "分析機能層"
        N[単日分析<br/>特定日付の詳細分析] --> O[時系列分析<br/>長期トレンド追跡]
        O --> P[業界別分析<br/>カテゴリ別比較]
        P --> Q[統計的検証<br/>信頼性評価]
    end

    G --> H
    B --> E
    C --> I
    C --> J
    C --> K
    C --> L
    C --> M
```

## 技術スタック構成図

```mermaid
graph LR
    subgraph "自動化・インフラ"
        A[GitHub Actions<br/>CI/CD自動実行] --> B[Python 3.9+<br/>メイン実行環境]
        B --> C[Amazon S3<br/>クラウドストレージ]
    end

    subgraph "データ収集・処理"
        D[Perplexity API<br/>AI検索サービス] --> E[Google Custom Search API<br/>従来型検索]
        E --> F[Pandas<br/>データ処理]
        F --> G[NumPy<br/>数値計算]
    end

    subgraph "分析・統計"
        H[SciPy<br/>統計分析] --> I[Statsmodels<br/>多重比較補正]
        I --> J[Scikit-learn<br/>機械学習]
    end

    subgraph "可視化・UI"
        K[Streamlit<br/>Webアプリケーション] --> L[Plotly<br/>インタラクティブ可視化]
        L --> M[Matplotlib<br/>静的グラフ]
        M --> N[Japanize Matplotlib<br/>日本語対応]
    end

    subgraph "データ管理"
        O[JSON<br/>データ形式] --> P[YAML<br/>設定管理]
        P --> Q[Pathlib<br/>ファイル操作]
    end

    C --> F
    D --> F
    G --> H
    J --> K
    N --> K
    Q --> B
```

## システム特性・優位性

### 1. 自動化による客観性確保
- GitHub Actionsによる完全自動実行
- 研究者の主観的判断の排除
- 24時間体制での継続監視

### 2. 多角的分析による包括的理解
- 感情分析 × ランキング分析の統合
- プラットフォーム間比較分析
- 市場構造との相関分析

### 3. 学術研究基盤としての貢献
- オープンソースでの公開
- 再現可能性の確保
- 標準化された指標体系

### 4. 実用的Webダッシュボード
- 直感的な操作インターフェース
- 専門知識不要の分析環境
- 多様なステークホルダー対応

### 5. 日本語圏特化設定
- 日本語での検索・回答分析
- 地域・文化的背景の考慮
- 日本企業・市場への特化

---

*図1: AI検索サービス企業優遇バイアス分析システムの全体アーキテクチャ*

*図2: 8段階データ収集パイプラインの詳細フロー*

*図3: 包括的バイアス評価指標体系*

*図4: Streamlitダッシュボードシステム構成*

*図5: 技術スタックとコンポーネント関係*