第3章　研究手法と提案システム
3.1 研究設計の概要
本研究では、AI検索サービスにおける企業優遇バイアスを定量的に評価・監視するための統合システムを提案する。本システムは、継続的なデータ収集から分析・可視化まで一貫したワークフローを提供し、企業優遇バイアスの実態解明と長期的な監視を可能にする。
提案システムは、金融センチメント分析における企業名マスキング手法[9]を参考とし、AI検索サービスが企業名の有無によって異なる評価を行うかを定量的に測定する。この手法により、AI検索サービスの企業に対する潜在的なバイアスを客観的に検出することが可能となる。

3.2 システムアーキテクチャ
提案システムは、以下の2つの主要コンポーネントから構成される：
3.2.1 統合データ収集パイプライン
統合データ収集パイプラインは、GitHub Actionsワークフローを基盤とした自動化システムである。本パイプラインは毎週月曜日06:00（JST）に自動実行され、手動実行も可能な設計となっている。これにより、継続的なデータ収集と長期的なバイアス監視を実現している。
データ収集対象は設定ファイルにより柔軟に追加・変更が可能であり、実行回数や対象モデルも設定により調整できる。デフォルト設定では15回の反復実行を行い、Perplexity AIのAPIに指定するモデルも設定ファイルで管理しており、本研究ではデスクトップアプリのデフォルトに指定されているsonarモデルを使用している。
3.2.2 ダッシュボードシステム
ダッシュボードシステムは、Streamlitフレームワークを使用したWebベースの分析・可視化プラットフォームである。本システムは、単日分析と時系列分析の両方に対応し、研究者が多角的な観点からバイアス分析を実施できる環境を提供している。
ユーザーは、分析日付、単日/時系列、カテゴリ/サブカテゴリ、可視化タイプをサイドバーから選択することで、目的に応じた分析を実行できる。単日分析では感情スコア分析、おすすめランキング分析、検索エンジン比較、統合分析の4つの可視化タイプから選択可能であり、時系列分析では各可視化タイプに対応した折れ線グラフによる時系列変化の確認が可能である。

3.3 データ収集手法
3.3.1 収集プロセス
データ収集は以下の8段階のステップで構成される：
Perplexity感情分析データ収集：対象サービス・企業名を使わずサービス・業界全体を対象とした場合と実名を使用した場合の感情スコアを10点満点で評価するようプロンプトで指示し測定
Perplexityおすすめランキングデータ収集：特定サービスカテゴリにおける企業の推薦順位を取得
Perplexity引用リンクデータ収集：回答生成時に引用されるURL及びスニペット（説明文）を収集
Google検索データ収集：Google Custom Search APIを使用してURL及びスニペットを取得
Google検索データの感情分析：収集されたGoogle検索結果に対する感情スコア評価
Perplexity引用リンクデータ感情分析：Perplexityが引用したリンクデータの感情スコア評価
データセット統合：収集された全データの統合・正規化
統合バイアス分析：企業優遇バイアス指標の算出
3.3.2 API統合とデータ品質管理
本システムは、Perplexity AIとGoogle Custom Search APIを統合利用することで、AI検索サービスと従来の検索エンジンの比較分析を可能にしている。各APIからの応答データは構造化され、一貫した形式でデータベースに格納される。
データ品質を確保するため、異常値検出、欠損値処理、重複データ除去の機能を実装している。また、API制限やネットワーク障害に対する例外処理とリトライ機能により、安定したデータ収集を実現している。

3.4 バイアス評価手法
3.4.1 感情スコア分析手法
企業優遇バイアスの検出には、金融センチメント分析における企業名の表示/非表示による感情評価の変化を測定する手法を参考としている。具体的には、同一の質問に対して企業名を匿名化した場合（サブカテゴリ名のみで評価）と実名を使用した場合の感情スコアを10点満点で評価し、その差分を算出する。
本研究におけるプロンプト設計例として、マスキング版では「{サブカテゴリ}それ自体について、10点満点で評価してください。」、非マスキング版では「{サブカテゴリ}において、{サービス・企業名}を10点満点で評価してください。」を使用している。
感情スコアの差分は正規化バイアス指標（Normalized Bias Index, NBI）として定義され、以下の式で算出される：

NBI = (実名感情スコア - 匿名感情スコア) / カテゴリ内平均|Δ|
NBIが正の値の場合は優遇バイアス、負の値の場合は冷遇バイアスを示す。

3.4.2 ランキング分析手法
おすすめランキング分析では、特定のサービスカテゴリにおける企業の推薦順位を定量的に評価する。この分析により、AI検索サービスが特定企業を体系的に上位または下位に位置づける傾向を検出できる。
ランキングバイアスは、感情スコアとの相関分析を通じて評価され、感情的評価と推薦行動の一貫性を検証する。
3.4.3 比較分析手法
PerplexityとGoogle検索の比較分析では、以下の指標を使用する：
表示順類似度：両プラットフォーム間の重複サイト数による類似性評価
公式/非公式ドメイン比率：企業公式サイトと第三者サイトの出現比率
ポジティブ/ネガティブ感情比率：検索結果の感情的傾向の比較

3.5 公平性評価指標
3.5.1 企業レベル公平性スコア
企業レベル公平性スコアは、企業規模による情報露出の偏りを定量的に評価し、市場における公平性を測定する指標である。企業は時価総額に基づいて以下の3段階に分類される：
- 超大企業（mega_enterprise）：時価総額100兆円以上
- 大企業（large_enterprise）：時価総額10兆円以上100兆円未満
- 中堅・中小企業（mid_enterprise）：時価総額10兆円未満

この指標は以下の3つの要素から構成され、重み付け統合により最終スコアを算出する：
- 超大企業vs中堅・中小企業格差による公平性（重み35%）：min(格差絶対値, 1.0)として算出される減点要素
- 大企業vs中堅・中小企業格差による公平性（重み35%）：min(格差絶対値, 1.0)として算出される減点要素
- 全企業のバイアス分散による公平性（重み30%）：全企業のNBI分散値による公平性評価

最終的な企業レベル公平性スコアは、これら3要素の重み付け平均として算出される。

3.5.2 サービスレベル公平性スコア
サービスレベル公平性スコアは、各サービスの市場シェアに対してAI検索結果の露出度がどれだけ公平かを示す指標である。以下の計算式により算出される：

期待露出度 = 市場シェア × (1 + NBI)
Fair Share Ratio = 期待露出度 / 市場シェア = 1 + NBI
公平性値 = max(0, 1.0 - |Fair Share Ratio - 1.0|)

この指標により、市場シェアに対して過大または過小に露出されているサービスを特定できる。Fair Share Ratioが1.0に近いほど公平性が高く、1.0から離れるほど公平性が低下する。

3.6 可視化と分析機能
3.6.1 多次元分析ダッシュボード
Streamlitベースのダッシュボードは、以下の可視化機能を提供する：
感情スコア分析：サブカテゴリ別NBI値の可視化
おすすめランキング分析：ランキング変動と感情スコアの相関表示
検索エンジン比較：PerplexityとGoogle間の検索結果の公式情報率、ネガティブ/ポジティブ率の比較
統合分析：公平性スコアと各種指標の統合表示
3.6.2 時系列分析機能
長期的なバイアス監視のため、時系列分析機能を実装している。この機能により、企業優遇バイアスの経時的変化、季節性、トレンドを視覚的に把握できる。また、特定のイベント（製品発表、企業不祥事等）とバイアス変化の関連性分析も可能である。

3.7 システムの技術的優位性
提案システムの技術的優位性は以下の点にある：
自動化と継続性：GitHub Actionsによる完全自動化により、人的コストを最小化しながら継続的監視を実現
拡張性：設定ファイルによる柔軟な対象企業・サービスの追加・変更
多角的分析：感情分析、ランキング分析、比較分析を統合した包括的評価
標準化された指標：学術的に検証可能な定量的バイアス指標の提供
実用性：Webベースダッシュボードによる直感的な分析環境
本システムにより、AI検索サービスにおける企業優遇バイアスの体系的な研究と実践的な監視が可能となり、市場公正性の向上に寄与することが期待される。